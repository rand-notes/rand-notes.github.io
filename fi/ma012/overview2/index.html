<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="2 cviko Na hladine vyznamnosti testujte nulovou hypotezu, ze stredni hodnoty trzeb vsechno proddavacu se rovnaji. Spocitejte ze hmotnost brambor nesouvisi s odrudou.
reseni: Levene a Bartletts test pro overeni ze variance(rozptyl) je podobna mezi skupinami Shapiruv-Wilkeuv a Kolmogorovuv-Smirnovuv test pro overeni normality ANOVA pro testovani stredni hodnoty Tukey a Scheffe pro porovnani ktere dvojice se nejvic lisi
R:
leveneTest(tabulka$hmotnost ~ tabulka$odruda) # odruda musi byt factor bartlett.test(tabulka$hmotnost ~ tabulka$odruda)"><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://rand-notes.github.io/fi/ma012/overview2/><title>overview 2 :: idk</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.7209ab6422eb371a6b685a56274cc88eff3db604665c3bdb698389c0585d4211.css><meta itemprop=name content="overview 2"><meta itemprop=description content="2 cviko Na hladine vyznamnosti testujte nulovou hypotezu, ze stredni hodnoty trzeb vsechno proddavacu se rovnaji. Spocitejte ze hmotnost brambor nesouvisi s odrudou.
reseni: Levene a Bartletts test pro overeni ze variance(rozptyl) je podobna mezi skupinami Shapiruv-Wilkeuv a Kolmogorovuv-Smirnovuv test pro overeni normality ANOVA pro testovani stredni hodnoty Tukey a Scheffe pro porovnani ktere dvojice se nejvic lisi
R:
leveneTest(tabulka$hmotnost ~ tabulka$odruda) # odruda musi byt factor bartlett.test(tabulka$hmotnost ~ tabulka$odruda)"><meta itemprop=wordCount content="1787"><meta itemprop=image content="https://rand-notes.github.io"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://rand-notes.github.io"><meta name=twitter:title content="overview 2"><meta name=twitter:description content="2 cviko Na hladine vyznamnosti testujte nulovou hypotezu, ze stredni hodnoty trzeb vsechno proddavacu se rovnaji. Spocitejte ze hmotnost brambor nesouvisi s odrudou.
reseni: Levene a Bartletts test pro overeni ze variance(rozptyl) je podobna mezi skupinami Shapiruv-Wilkeuv a Kolmogorovuv-Smirnovuv test pro overeni normality ANOVA pro testovani stredni hodnoty Tukey a Scheffe pro porovnani ktere dvojice se nejvic lisi
R:
leveneTest(tabulka$hmotnost ~ tabulka$odruda) # odruda musi byt factor bartlett.test(tabulka$hmotnost ~ tabulka$odruda)"><meta property="og:title" content="overview 2"><meta property="og:description" content="2 cviko Na hladine vyznamnosti testujte nulovou hypotezu, ze stredni hodnoty trzeb vsechno proddavacu se rovnaji. Spocitejte ze hmotnost brambor nesouvisi s odrudou.
reseni: Levene a Bartletts test pro overeni ze variance(rozptyl) je podobna mezi skupinami Shapiruv-Wilkeuv a Kolmogorovuv-Smirnovuv test pro overeni normality ANOVA pro testovani stredni hodnoty Tukey a Scheffe pro porovnani ktere dvojice se nejvic lisi
R:
leveneTest(tabulka$hmotnost ~ tabulka$odruda) # odruda musi byt factor bartlett.test(tabulka$hmotnost ~ tabulka$odruda)"><meta property="og:type" content="article"><meta property="og:url" content="https://rand-notes.github.io/fi/ma012/overview2/"><meta property="og:image" content="https://rand-notes.github.io"><meta property="article:section" content="fi"><meta property="og:site_name" content="idk"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo>title</div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/posts>notes</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://rand-notes.github.io/fi/ma012/overview2/>overview 2</a></h2><div class=post-content><h1 id=2-cviko>2 cviko</h1><p>Na hladine vyznamnosti testujte nulovou hypotezu, ze stredni hodnoty trzeb vsechno proddavacu
se rovnaji.
Spocitejte ze hmotnost brambor nesouvisi s odrudou.</p><p>reseni:
<strong>Levene a Bartletts</strong> test pro overeni ze variance(rozptyl) je podobna mezi skupinami
<strong>Shapiruv-Wilkeuv a Kolmogorovuv-Smirnovuv</strong> test pro overeni normality
<strong>ANOVA</strong> pro testovani stredni hodnoty
<strong>Tukey a Scheffe</strong> pro porovnani ktere dvojice se nejvic lisi</p><p>R:</p><p>leveneTest(tabulka$hmotnost ~ tabulka$odruda) # odruda musi byt factor
bartlett.test(tabulka$hmotnost ~ tabulka$odruda)</p><p>Shapiro–Wilk:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e># nejdriv si rozdelime do nekolika tabulek podle odrud</span>
</span></span><span style=display:flex><span>skupiny <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lapply</span>(<span style=color:#a6e22e>levels</span>(tabulka<span style=color:#f92672>$</span>odruda), <span style=color:#a6e22e>function</span>(L) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>return</span>(<span style=color:#a6e22e>subset</span>(tabulka, odruda <span style=color:#f92672>==</span> L))
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># a pak aplikujeme Shapiro nebo Kolmogorov–Smirnov</span>
</span></span><span style=display:flex><span>skupiny <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lapply</span>(<span style=color:#a6e22e>levels</span>(tabulka<span style=color:#f92672>$</span>odruda), <span style=color:#a6e22e>function</span>(L) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>return</span>(<span style=color:#a6e22e>subset</span>(tabulka, odruda <span style=color:#f92672>==</span> L))
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>lapply</span>(skupiny, <span style=color:#a6e22e>function</span>(x) {
</span></span><span style=display:flex><span>  X <span style=color:#f92672>&lt;-</span> x<span style=color:#f92672>$</span>hmotnost
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ks.test</span>(X, <span style=color:#e6db74>&#34;pnorm&#34;</span>, mean <span style=color:#f92672>=</span> <span style=color:#a6e22e>mean</span>(X), sd <span style=color:#f92672>=</span> <span style=color:#a6e22e>sd</span>(X))
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alternativne to muzem projet po jednom
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>shapiro.test</span>(tabulka[tabulka<span style=color:#f92672>$</span>odruda <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>, ]<span style=color:#f92672>$</span>hmotnost)
</span></span><span style=display:flex><span><span style=color:#a6e22e>shapiro.test</span>(tabulka[tabulka<span style=color:#f92672>$</span>odruda <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>, ]<span style=color:#f92672>$</span>hmotnost)
</span></span></code></pre></div><p>ANOVA:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span>aov.model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>aov</span>(tabulka<span style=color:#f92672>$</span>hmotnost <span style=color:#f92672>~</span> tabulka<span style=color:#f92672>$</span>odruda)
</span></span><span style=display:flex><span>aov.model
</span></span></code></pre></div><p>Tukey a Scheffe:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span>ScheffeTest <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>scheffe.test</span>(aov.model, <span style=color:#e6db74>&#34;tabulka$odruda&#34;</span>)
</span></span><span style=display:flex><span>ScheffeTest
</span></span><span style=display:flex><span>ScheffeTest<span style=color:#f92672>$</span>groups
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TukeyTest <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>TukeyHSD</span>(aov.model)
</span></span><span style=display:flex><span>TukeyTest
</span></span><span style=display:flex><span><span style=color:#a6e22e>plot</span>(TukeyTest, las <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>) <span style=color:#75715e># graficky </span>
</span></span></code></pre></div><p>Linearni regresni model:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span>model3 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lm</span>(Y <span style=color:#f92672>~</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> x <span style=color:#f92672>+</span> <span style=color:#a6e22e>I</span>(x^2) <span style=color:#f92672>+</span> <span style=color:#a6e22e>I</span>(x^3), data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span>model2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lm</span>(Y <span style=color:#f92672>~</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> x <span style=color:#f92672>+</span> <span style=color:#a6e22e>I</span>(x^2), data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span>model1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lm</span>(Y <span style=color:#f92672>~</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> x, data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(model3)
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(model2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(model1)
</span></span></code></pre></div><h1 id=3-cviko>3 cviko</h1><p>Zkoumame vynosy sena v zavislosti na typu pudy a hnojeni. Kazda kombinace byla realizovana
ctyrikrat, nezavisle na sobe. Provdte analyzu rozptylu pomoci dvojneho trideni bez interakci,
dvojneho trideni s interakcemi i pomoci jednoducheho trideni.</p><p>Reseni:</p><p>Opet Bartlett a Levene pro varianci a Shapiro a KS pro normalitu.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e># dvojne trideni bez interakci</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aov.model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>aov </span>(vynos <span style=color:#f92672>~</span> puda <span style=color:#f92672>+</span> hnojeni, data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary </span>(aov.model)
</span></span><span style=display:flex><span>aov.model<span style=color:#f92672>$</span>coefficients
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Mnohonasobne porovnavani</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TukeyTest <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>TukeyHSD </span>(aov.model)
</span></span><span style=display:flex><span>TukeyTest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ScheffeTest.puda <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>scheffe.test </span>(aov.model, <span style=color:#e6db74>&#34;puda&#34;</span>)
</span></span><span style=display:flex><span>ScheffeTest.puda<span style=color:#f92672>$</span>groups
</span></span><span style=display:flex><span>ScheffeTest.hnojeni <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>scheffe.test </span>(aov.model, <span style=color:#e6db74>&#34;hnojeni&#34;</span>)
</span></span><span style=display:flex><span>ScheffeTest.hnojeni<span style=color:#f92672>$</span>groups
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Dvojne trideni s interakcemi</span>
</span></span><span style=display:flex><span>aov.model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>aov </span>(vynos <span style=color:#f92672>~</span> puda <span style=color:#f92672>*</span> hnojeni, data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span>aov.model
</span></span></code></pre></div><h1 id=4-cviko>4 cviko</h1><p>Testuje hypotezu, ze polovina testovanych osob doby jedne minuty podhodnotila a polovina
nadhodnotila.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e># znamenkovy test</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SIGN.test</span>(X, md <span style=color:#f92672>=</span> <span style=color:#ae81ff>60</span>) <span style=color:#75715e># p-hodnota &gt; 0.05 =&gt; nezamitame nulovou hypotezu </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Wilcoxonuv signed-rank test / jednovyberovy wilcoxon</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>wilcox.test</span>(X, mu <span style=color:#f92672>=</span> <span style=color:#ae81ff>60</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># dvouvyberovy wilcoxonuv test</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>wilcox.test </span>(X, Y)
</span></span></code></pre></div><p>Brambory - pomoci Kruskal-Wallis a median testu pro jednoduche trideni testujte H, ze stredni
hodnota hmotnosti trsu brambor nezavisi na odrude. Naleznete odlisne dvojice.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e># Jednoduche trideni: Kruskaluv-Wallisuv test</span>
</span></span><span style=display:flex><span><span style=color:#75715e># p-hodnota &lt; 0.05 =&gt; zamitame nulovou hypotezu o rovnosti vsech medianu </span>
</span></span><span style=display:flex><span>KWtest <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>kruskal</span>(tabulka<span style=color:#f92672>$</span>hmotnost, tabulka<span style=color:#f92672>$</span>odruda)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Jednoduche trideni: Medianovy test</span>
</span></span><span style=display:flex><span>Mtest <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>Median.test</span>(tabulka<span style=color:#f92672>$</span>hmotnost, tabulka<span style=color:#f92672>$</span>odruda)
</span></span></code></pre></div><h1 id=5-cviko>5 cviko</h1><p>Byl vybran pocet chlapcu v rodinach. Testujte ze pocet chlapcu v rodinach ma binomicke
rozdeleni Bi(5; 0.5);</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span>tabulka <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv2</span>(file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;data/rodiny.csv&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pc <span style=color:#f92672>=</span> tabulka<span style=color:#f92672>$</span>pocet_chlapcu <span style=color:#75715e>#diskretni kategorie</span>
</span></span><span style=display:flex><span>k <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length </span>(pc)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pr <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>pocet_rodin <span style=color:#75715e>#Z nahodneho vyberu mame empiricke cetnosti</span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(pr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bin <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>dbinom </span>(pc, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>, prob <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Matice <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind </span>(pr, n <span style=color:#f92672>*</span> bin) <span style=color:#75715e># umistime empiricke i teoreticke cetnosti do jedne matice jako dva radky</span>
</span></span><span style=display:flex><span>Matice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Yarnoldovo kriterium </span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(n <span style=color:#f92672>*</span> bin <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>/</span> k
</span></span><span style=display:flex><span>n <span style=color:#f92672>*</span> bin <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> q <span style=color:#75715e># output: TRUE TRUE TRUE TRUE TRUE TRUE</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Yarnoldovo kriterium  je splneno</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Testovaci statistika</span>
</span></span><span style=display:flex><span>K <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(pr^2 <span style=color:#f92672>/</span> (n <span style=color:#f92672>*</span> bin)) <span style=color:#f92672>-</span> n
</span></span><span style=display:flex><span>K <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>qchisq </span>(<span style=color:#ae81ff>0.95</span>, df <span style=color:#f92672>=</span> k <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#75715e>#output: FALSE</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Hypotezu o shode dat s rozdelenim Bi (5; 0.5) nezamitame</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Podminka dobre aproximace </span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>*</span> bin <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span> 
</span></span><span style=display:flex><span><span style=color:#75715e>#	Prvni a posledni kategorie maji nizke teoreticke cestnosti, Sloucime tedy prvni 2 a posledni 2 kategorie</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Slouceni kategorii</span>
</span></span><span style=display:flex><span>pc2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(<span style=color:#e6db74>&#34;0-1&#34;</span>, pc[3<span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>], <span style=color:#e6db74>&#34;4-5&#34;</span>)
</span></span><span style=display:flex><span>k2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length </span>(pc)
</span></span><span style=display:flex><span>pr2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(<span style=color:#a6e22e>sum </span>(pr[1<span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>]), pr[3], pr[4], <span style=color:#a6e22e>sum </span>(pr[5<span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>]))
</span></span><span style=display:flex><span>bin2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(<span style=color:#a6e22e>sum </span>(bin[1<span style=color:#f92672>:</span><span style=color:#ae81ff>2</span>]), bin[3], bin[4], <span style=color:#a6e22e>sum </span>(bin[5<span style=color:#f92672>:</span><span style=color:#ae81ff>6</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># to stejny - ale ted uz je podmnika splnena</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Matice <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind </span>(pr2, n <span style=color:#f92672>*</span> bin2)
</span></span><span style=display:flex><span>Matice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>*</span> bin2 <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>K <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(pr2^2 <span style=color:#f92672>/</span> (n <span style=color:#f92672>*</span> bin2)) <span style=color:#f92672>-</span> n
</span></span><span style=display:flex><span>K <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>qchisq </span>(<span style=color:#ae81ff>0.95</span>, df <span style=color:#f92672>=</span> k2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#75715e>#output: FALSE</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Hypotezu o shode dat s rozdelenim Bi (5; 0.5) nezamitame</span>
</span></span></code></pre></div><p>Sledovana doba cekani na obsluhu. Testujte zda ma exponencialni rozdeleni pst. a to testem
dobre shody a testem pro exponencialni rozdeleni.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span>tabulka <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv2</span>(file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;data/fronta.csv&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>str</span>(tabulka)
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(tabulka)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tabulka
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># kategorie</span>
</span></span><span style=display:flex><span>dcc <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.character </span>(tabulka<span style=color:#f92672>$</span>doba_cekani) <span style=color:#75715e># doba cekani char</span>
</span></span><span style=display:flex><span>k <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length </span>(dcc)
</span></span><span style=display:flex><span>dc <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq </span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>24</span>, by <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>) <span style=color:#75715e># doba cekani</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Z nahodneho vyberu mame empiricke cetnosti</span>
</span></span><span style=display:flex><span>pz <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>pocet_zakazniku
</span></span><span style=display:flex><span>n <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(pz)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Odhad parametru lambda v exponencialnim rozdeleni </span>
</span></span><span style=display:flex><span>prumer <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq </span>(<span style=color:#ae81ff>1.5</span>, <span style=color:#ae81ff>22.5</span>, by <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>) <span style=color:#75715e># stredy v intervalech</span>
</span></span><span style=display:flex><span>lambda <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> (<span style=color:#a6e22e>sum </span>(prumer <span style=color:#f92672>*</span> pz) <span style=color:#f92672>/</span> n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Dopocitame teoreticke pravdepodobnosti z predpokladu exponencialniho rozdeleni s lambda </span>
</span></span><span style=display:flex><span>dck <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>pexp </span>(dc, lambda) <span style=color:#75715e># distribucni funkce v krajnich bodech</span>
</span></span><span style=display:flex><span>pst <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>diff </span>(dck) <span style=color:#75715e># pravdepodobnost = rozdil hodnot distribucni funkce</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Soucet pravdepodobnosti ale neni 1, nebot chybi kategorie &#34;&gt; 24&#34;</span>
</span></span><span style=display:flex><span>dcc <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(dcc, <span style=color:#e6db74>&#34;&gt; 24&#34;</span>)
</span></span><span style=display:flex><span>k <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length </span>(dcc)
</span></span><span style=display:flex><span>pz <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(pz, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>pst <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(pst, <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>pexp </span>(<span style=color:#ae81ff>24</span>, lambda))
</span></span><span style=display:flex><span><span style=color:#75715e>#	kontrola: soucet psti = 1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum </span>(pst)	
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Sloupcove grafy empirickych a teoretickych cetnosti</span>
</span></span><span style=display:flex><span>Matice <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind </span>(pz, n <span style=color:#f92672>*</span> pst)	<span style=color:#75715e>#	umistime empiricke i teoreticke cetnosti do jedne matice jako dva radky</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>barplot </span>(Matice, names.arg <span style=color:#f92672>=</span> dcc, beside <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, main <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;doba cekani&#34;</span>, ylab <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;pocet zakazniku&#34;</span>, col <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;orange&#34;</span>, <span style=color:#e6db74>&#34;cyan&#34;</span>), las <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Podminka dobre aproximace </span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>*</span> pst <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span> 
</span></span><span style=display:flex><span><span style=color:#75715e># Yarnoldovo kriterium</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(n <span style=color:#f92672>*</span> pst <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>/</span> k
</span></span><span style=display:flex><span>q
</span></span><span style=display:flex><span>n <span style=color:#f92672>*</span> pst <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Podle podminky dobre aproximace bychom spojili posledni dve dvojice kategorii.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Podle Yarnoldova kriteria bude stacit spojit posledni 2 kategorie do nove &#34;&gt; 21&#34;.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Nam postaci splneni Yarnoldova kriteria. </span>
</span></span><span style=display:flex><span>dcc2 <span style=color:#f92672>&lt;-</span> dcc[1<span style=color:#f92672>:</span>(k<span style=color:#ae81ff>-1</span>)]
</span></span><span style=display:flex><span>k2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length </span>(dcc2)
</span></span><span style=display:flex><span>dcc2[k2] <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;&gt; 21&#34;</span>
</span></span><span style=display:flex><span>pz2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(pz[1<span style=color:#f92672>:</span>(k2<span style=color:#ae81ff>-1</span>)], pz[k2] <span style=color:#f92672>+</span> pz[k])
</span></span><span style=display:flex><span>pst2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c </span>(pst[1<span style=color:#f92672>:</span>(k2<span style=color:#ae81ff>-1</span>)], pst[k2] <span style=color:#f92672>+</span> pst[k])
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum </span>(pz2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum </span>(pst2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Matice <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind </span>(pz2, n <span style=color:#f92672>*</span> pst2)	<span style=color:#75715e>#	umistime empiricke i teoreticke cetnosti do jedne matice jako dva radky</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>barplot </span>(Matice, names.arg <span style=color:#f92672>=</span> dcc2, beside <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, main <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;doba cekani&#34;</span>, ylab <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;pocet zakazniku&#34;</span>, col <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;orange&#34;</span>, <span style=color:#e6db74>&#34;cyan&#34;</span>), las <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Yarnoldovo kriterium</span>
</span></span><span style=display:flex><span>q <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(n <span style=color:#f92672>*</span> pst2 <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>5</span>) <span style=color:#f92672>/</span> k2
</span></span><span style=display:flex><span>q
</span></span><span style=display:flex><span>n <span style=color:#f92672>*</span> pst2 <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> q
</span></span><span style=display:flex><span><span style=color:#75715e>#	Yarnoldovo kriterium je nyni jiz splneno</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Testovaci statistika</span>
</span></span><span style=display:flex><span>K <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sum </span>(pz2^2 <span style=color:#f92672>/</span> (n <span style=color:#f92672>*</span> pst2)) <span style=color:#f92672>-</span> n
</span></span><span style=display:flex><span><span style=color:#75715e>#	Kvantil a porovnani </span>
</span></span><span style=display:flex><span>K
</span></span><span style=display:flex><span><span style=color:#75715e># Stupne volnosti snizujeme navic o 1 za odhadnuty parametr lambda </span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>qchisq </span>(<span style=color:#ae81ff>0.95</span>, df <span style=color:#f92672>=</span> k2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>K <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>qchisq </span>(<span style=color:#ae81ff>0.95</span>, df <span style=color:#f92672>=</span> k2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#	Hypotezu o shode dat s exponencialnim rozdelenim testem dobre shody nezamitame</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Specificky test</span>
</span></span><span style=display:flex><span>pz <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>pocet_zakazniku
</span></span><span style=display:flex><span>X <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rep </span>(prumer, pz)
</span></span><span style=display:flex><span>Q <span style=color:#f92672>&lt;-</span> (n<span style=color:#ae81ff>-1</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>var </span>(X) <span style=color:#f92672>/</span> (<span style=color:#a6e22e>mean </span>(X))^2 
</span></span><span style=display:flex><span>Q
</span></span><span style=display:flex><span>q1 <span style=color:#f92672>=</span> <span style=color:#a6e22e>qchisq </span>(<span style=color:#ae81ff>0.025</span>, n<span style=color:#ae81ff>-1</span>)
</span></span><span style=display:flex><span>q2 <span style=color:#f92672>=</span> <span style=color:#a6e22e>qchisq </span>(<span style=color:#ae81ff>0.975</span>, n<span style=color:#ae81ff>-1</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>c </span>(q1, q2)
</span></span><span style=display:flex><span>Q <span style=color:#f92672>&lt;=</span> q1 <span style=color:#f92672>|</span> Q <span style=color:#f92672>&gt;=</span> q2
</span></span><span style=display:flex><span><span style=color:#75715e>#	Hypotezu o shode dat s exponencialnim rozdelenim Specifickym testem zamitame</span>
</span></span></code></pre></div><h1 id=6-cviko>6 cviko</h1><p>Byli sledovan pocet clenu (C), prijmy (P) a vydaje (V) za potraviny a napoje. Dale spocitejte koeficient mnohonasobne korelace mezi vydaji a zbylymi 2 velicinami.</p><p>Korelace meri silu zavislosti, kovariance meri smer.</p><p>Spearmanův korelační koeficient udává statistickou závislost (korelaci) mezi dvěma veličinami.
Kendallovo tau - measure the ordinal association between two measured quantities</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#a6e22e>library</span>(<span style=color:#e6db74>&#34;Hmisc&#34;</span>)			<span style=color:#75715e>#	rcorr</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(<span style=color:#e6db74>&#34;corrplot&#34;</span>)		<span style=color:#75715e>#	corrplot</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(<span style=color:#e6db74>&#34;ppcor&#34;</span>)			<span style=color:#75715e>#	pcor, pcor.test</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(<span style=color:#e6db74>&#34;rgl&#34;</span>)		<span style=color:#75715e># 3D grafika </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Nacteni dat</span>
</span></span><span style=display:flex><span>tabulka <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv2</span>(<span style=color:#e6db74>&#34;data/domacnosti.csv&#34;</span>, header <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, skip <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>C
</span></span><span style=display:flex><span>P <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>P
</span></span><span style=display:flex><span>V <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>V
</span></span><span style=display:flex><span>X <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.matrix</span>(tabulka) <span style=color:#75715e># C, P, V jako sloupce</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Ciselne charakterisitky </span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>apply</span>(X, <span style=color:#ae81ff>2</span>, mean)
</span></span><span style=display:flex><span><span style=color:#a6e22e>cov</span>(X)
</span></span><span style=display:flex><span><span style=color:#a6e22e>cor</span>(X)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Scatter-plot</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>pairs</span>(X)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	MNOHONASOBNA LINEARNI REGRESE</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Linearni regresni model</span>
</span></span><span style=display:flex><span>model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lm</span>(V <span style=color:#f92672>~</span> P <span style=color:#f92672>+</span> C, data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span><span style=color:#75715e>#	Koeficienty mnohonasobne linearni regrese</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(model)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Predikce vynosu (V) v zavislosti na poctu clenu domacnosti (C) a prijmech (P)</span>
</span></span><span style=display:flex><span>c <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>, by <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.1</span>) <span style=color:#75715e># 1 a 5 je min a max v C</span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>150</span>, by <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.1</span>) <span style=color:#75715e># 0 a 150 je min a max v P</span>
</span></span><span style=display:flex><span>grid.2d <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>expand.grid</span>(C <span style=color:#f92672>=</span> c, P <span style=color:#f92672>=</span> p)
</span></span><span style=display:flex><span>prediction <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>predict</span>(model, grid.2d, interval <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;prediction&#34;</span>)
</span></span><span style=display:flex><span>V.predicted <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>matrix</span>(prediction[,<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>length </span>(c), <span style=color:#a6e22e>length </span>(p))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	KORELACNI ANALYZA</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Korelacni matice a testy vyznamnosti</span>
</span></span><span style=display:flex><span>R <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rcorr</span>(X)
</span></span><span style=display:flex><span>R<span style=color:#f92672>$</span>r
</span></span><span style=display:flex><span>R<span style=color:#f92672>$</span>P
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	Matice parcialnich korelaci a testy vyznamnosti</span>
</span></span><span style=display:flex><span>parc <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>pcor</span>(X)
</span></span><span style=display:flex><span>parc<span style=color:#f92672>$</span>estimate
</span></span><span style=display:flex><span>parc<span style=color:#f92672>$</span>p.value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	MNOHONASOBNA KORELACE</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#	V . C P</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. jako korelace s nejlepsim linearnim odhadem</span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lm</span>(V <span style=color:#f92672>~</span> C <span style=color:#f92672>+</span> P, data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span>v <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>summary</span>(m)
</span></span><span style=display:flex><span><span style=color:#a6e22e>cor</span>(V, m<span style=color:#f92672>$</span>fitted.values)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. jako r.squared v linearnim regresnim modelu</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sqrt</span>(v<span style=color:#f92672>$</span>r.squared)
</span></span></code></pre></div><h1 id=7-cviko>7 cviko</h1><p>Durbin-Watson - test statistic used to detect the presence of autocorrelation at lag 1 in the residuals (prediction errors).
Cochran-Orcutt - obdobné procedury pro korekci autokorelace</p><p>Pomoci lienarni modelu s AR(1) modelujte zavislost druhe odmocniny poctu ptactva na case (v rocich). Overte, zda se v datech vyskytuje autoregrese 1. radu a prip ji odstrante.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span>tabulka <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv </span>(file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;data/Hawaii.csv&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>str</span>(tabulka)
</span></span><span style=display:flex><span>tabulka<span style=color:#f92672>$</span>Y <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>sqrt</span>(tabulka<span style=color:#f92672>$</span>Birds)
</span></span><span style=display:flex><span>Year.min <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>min</span>(tabulka<span style=color:#f92672>$</span>Year)
</span></span><span style=display:flex><span>tabulka<span style=color:#f92672>$</span>t <span style=color:#f92672>&lt;-</span> tabulka<span style=color:#f92672>$</span>Year <span style=color:#f92672>-</span> Year.min 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># plot(tabulka$Year, tabulka$Y, type = &#34;p&#34;, pch = 21, col = &#34;black&#34;, bg = &#34;yellow&#34;, xlab = &#34;Year (= t + 1956)&#34;, ylab = &#34;sqrt (Birds)&#34;, main = &#34;OLS&#34;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lm</span>(Y <span style=color:#f92672>~</span> t, data <span style=color:#f92672>=</span> tabulka) <span style=color:#75715e># Y pocet ptactva, t je pocet roku od zacatku mereni (roky)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(model, correlation <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>confint</span>(model) <span style=color:#75715e># Computes confidence intervals for one or more parameters in a fitted model.</span>
</span></span><span style=display:flex><span>tt <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq</span>(<span style=color:#a6e22e>min </span>(tabulka<span style=color:#f92672>$</span>t), <span style=color:#a6e22e>max </span>(tabulka<span style=color:#f92672>$</span>t), by <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.1</span>)
</span></span><span style=display:flex><span>Yhat <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>predict</span>(model, <span style=color:#a6e22e>data.frame </span>(t <span style=color:#f92672>=</span> tt))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># rezidua</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>&lt;-</span> model<span style=color:#f92672>$</span>residuals
</span></span><span style=display:flex><span>n <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length</span>(r)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># korelace mezi rezidui s o 1 posunutymi indexy</span>
</span></span><span style=display:flex><span>r1 <span style=color:#f92672>&lt;-</span> r[<span style=color:#f92672>-</span>n]
</span></span><span style=display:flex><span>r2 <span style=color:#f92672>&lt;-</span> r[<span style=color:#ae81ff>-1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># odhad theta</span>
</span></span><span style=display:flex><span>theta <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>cor</span>(r1, r2)
</span></span><span style=display:flex><span>theta
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>theta1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.numeric</span>( (<span style=color:#a6e22e>t</span>(r1) <span style=color:#f92672>%*%</span> r2) <span style=color:#f92672>/</span> (<span style=color:#a6e22e>t</span>(r1) <span style=color:#f92672>%*%</span> r1))
</span></span><span style=display:flex><span>theta1
</span></span><span style=display:flex><span><span style=color:#75715e># asymptoticky test</span>
</span></span><span style=display:flex><span>alpha <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>0.05</span>
</span></span><span style=display:flex><span>U <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>sqrt</span>(n) <span style=color:#f92672>*</span> theta1)
</span></span><span style=display:flex><span><span style=color:#a6e22e>c</span>(U <span style=color:#f92672>=</span> U, kvantil <span style=color:#f92672>=</span> <span style=color:#a6e22e>qnorm </span>(<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> alpha<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)) 
</span></span><span style=display:flex><span>U <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>qnorm </span>(<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> alpha<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)  
</span></span><span style=display:flex><span><span style=color:#75715e># Zamitame hypotezu H: theta = 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Durbinova-Watsonova statistika</span>
</span></span><span style=display:flex><span>DW <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>dwtest</span>(Y <span style=color:#f92672>~</span> t, data <span style=color:#f92672>=</span> tabulka)
</span></span><span style=display:flex><span>D <span style=color:#f92672>&lt;-</span> DW<span style=color:#f92672>$</span>statistic
</span></span><span style=display:flex><span>D
</span></span><span style=display:flex><span><span style=color:#75715e># Dtest</span>
</span></span><span style=display:flex><span>DW<span style=color:#f92672>$</span>p.value 
</span></span><span style=display:flex><span><span style=color:#75715e># Take zamitame hypotezu H: theta = 0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># odhad theta z D-W statistiky</span>
</span></span><span style=display:flex><span>theta2 <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>unname</span>(D) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>theta2
</span></span></code></pre></div><h1 id=9-cviko>9 cviko</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e># definice GLM modelu</span>
</span></span><span style=display:flex><span>m1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>glm</span>(formula <span style=color:#f92672>=</span> <span style=color:#a6e22e>cbind</span>(killed, population <span style=color:#f92672>-</span> killed) <span style=color:#f92672>~</span> dose, family <span style=color:#f92672>=</span> <span style=color:#a6e22e>binomial</span>(link <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;logit&#34;</span>), data <span style=color:#f92672>=</span> tab) <span style=color:#75715e># killed, population, dose - vsechno array - casova osa</span>
</span></span><span style=display:flex><span>m2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>glm</span>(formula <span style=color:#f92672>=</span> <span style=color:#a6e22e>cbind</span>(killed, population <span style=color:#f92672>-</span> killed) <span style=color:#f92672>~</span> dose, family <span style=color:#f92672>=</span> <span style=color:#a6e22e>binomial</span>(link <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;probit&#34;</span>), data <span style=color:#f92672>=</span> tab)
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(m1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># linearni prediktor</span>
</span></span><span style=display:flex><span>eta1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>predict</span>(m1, <span style=color:#a6e22e>data.frame</span>(dose <span style=color:#f92672>=</span> t), type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;link&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># linearni preditkor s 95% pasem spolehlivosti</span>
</span></span><span style=display:flex><span>fit1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>predict</span>(m1, <span style=color:#a6e22e>data.frame</span>(dose <span style=color:#f92672>=</span> t), type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;link&#34;</span>, se.fit <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span></code></pre></div></div></article><hr><div class=post-info></div></main></div><footer class=footer></footer><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script></div><script type=text/javascript src=/bundle.min.e8a56c89d5ca304d6922b22e38d0af2db97fa70a6623ba17a492092da773dfa4b9aaffa0f682ecfd03d7c7964e89bdbef18f0d4183c698831978c7ca44959d10.js integrity="sha512-6KVsidXKME1pIrIuONCvLbl/pwpmI7oXpJIJLadz36S5qv+g9oLs/QPXx5ZOib2+8Y8NQYPGmIMZeMfKRJWdEA=="></script></body></html>